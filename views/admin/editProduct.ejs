<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Profile - My Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .sidebar {
        width:150px;
        height:100vh;
        overflow-y:auto;
        position:sticky;
        top:0;
        background:#051922;
        border-right:1px solid #033047;
        transition:all .3s ease;
    }
    .sidebar h5{
        color:#F28123;
        position:sticky;
        top:0;
        background:#051922;
        padding:.75rem;
        border-bottom:1px solid #033047;
    }
    .sidebar .list-group-item {
        background:#051922;
        color:white;
        border:none;
        transition:.3s;
    }
    .sidebar .list-group-item:hover {
        background:#F28123;
        color:#051922;
    }
    .sidebar .list-group-item.active {
        background:#F28123;
        color:#051922;
        font-weight:600;
    }
    .mobile-header {
        background:#051922;
        border-bottom:1px solid #033047;
    }
    #menu-toggle {
        border:none;
        background:none;
        width:30px;
        height:24px;
        position:relative;
        display:flex;
        flex-direction:column;
        justify-content:space-between;
        cursor:pointer;
        padding:0;
    }
    #menu-toggle::before,#menu-toggle::after,#menu-toggle span{content:'';display:block;height:3px;width:100%;background:white;border-radius:2px;transition:all .3s;}
    #menu-toggle.active::before{transform:translateY(9px) rotate(45deg);background:orange;}
    #menu-toggle.active::after{transform:translateY(-9px) rotate(-45deg);background:orange;}
    #menu-toggle.active span{background:transparent;}
    @media(max-width:767.98px){.sidebar{width:100%;height:auto;display:none;border-bottom:1px solid #033047;}.sidebar.show{display:block;}}
  </style>
</head>
<body class="bg-light">

<header class="mobile-header d-flex justify-content-between align-items-center p-2 d-md-none">
  <h5 class="mb-0 text-light">My Admin</h5>
  <button id="menu-toggle"><span></span></button>
</header>

<div class="d-flex flex-column flex-md-row">
    <!-- Sidebar -->
    <aside class="sidebar border-end" id="sidebar">
      <h5 class="p-3 border-bottom d-none d-md-block">My Admin</h5>
    <nav class="list-group list-group-flush">
      <a href="/admin" class="list-group-item list-group-item-action ">Dashboard</a>
      <a href="/admin/orders" class="list-group-item list-group-item-action">Orders</a>
      <a href="/admin/products" class="list-group-item list-group-item-action ">Products</a>
      <a href="/admin/customers" class="list-group-item list-group-item-action">Customers</a>
      <a href="/admin/editProduct" class="list-group-item list-group-item-action active">Gallery</a>
      <a href="/admin/coupons" class="list-group-item list-group-item-action">Coupons</a>
      <a href="/admin/settings" class="list-group-item list-group-item-action">Settings</a>
      <a href="/admin/support" class="list-group-item list-group-item-action">Support</a>
      <a href="/admin/profile" class="list-group-item list-group-item-action">Profile</a>
    </nav>
    </aside>

  <main class="flex-fill p-4" style="background:#e27a25; min-height:100vh;">

    <div class="card shadow p-4">
      <h3 class="fw-bold mb-4">Fruit Search</h3>

      <!-- Search Form -->
      <form id="searchForm" class="mb-4">
        <div class="d-flex gap-2">
          <input 
            type="text" 
            id="fruitName" 
            placeholder="Enter fruit name..." 
            class="form-control"
            required
          >
          <button class="btn btn-dark px-4">Search</button>
        </div>
      </form>

    <div id="resultBox">

    </div>
    </div>

  </main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const toggleBtn=document.getElementById('menu-toggle');
  const sidebar=document.getElementById('sidebar');
  toggleBtn.addEventListener('click',()=>{sidebar.classList.toggle('show');toggleBtn.classList.toggle('active');});
</script>

<script>
  document.getElementById("searchForm").addEventListener("submit", async function(e){

    e.preventDefault();//stop reload

    const name = document.getElementById("fruitName").value;
    if(!name) return;
    
    const res = await fetch(`/admin/editProduct/product-search?fruitName=${encodeURIComponent(name)}`);

        const data = await res.json();

    const box = document.getElementById("resultBox");

    if (!data.product) {
        box.innerHTML = `<p class="text-danger fw-bold mt-3">Product not found</p>`;
        return;
    }

    const p = data.product;

    box.innerHTML = `
    <div class="table-responsive mt-4">
      <table class="table table-bordered align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Category</th>
            ${(p.gallery && p.gallery.length > 0)? `<th>Gallery</th>`:''}
            <th>Add Images</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><img src="${p.image}" style="width:100px;height:80px;object-fit:cover;"></td>

            <td>${p.name}</td>
            <td>${p.category}</td>

            ${(p.gallery && p.gallery.length > 0)? 
            `<td class="text-center">
              <div class="d-flex flex-wrap gap-2 justify-content-center">
                ${
                  p.gallery.map(img => 
                    `<img src="${img}" style="width:100px;height:80px;object-fit:cover;">`
                  ).join("")
                }
              </div>
            </td>`:''}
            
            ${(!p.gallery || !(p.gallery.length > 5))? 
            ` <td>
              <input type="file" name='images' accept="image/*" multiple class="form-control">
            </td>`: ''}
           
          </tr>
        </tbody>
      </table>
    </div>
    `;
  } )

</script>
</body>
</html>
