<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain from https://imransdesign.com/">

	<!-- title -->
	<title>Check Out</title>

	<!-- favicon -->
	<link rel="shortcut icon" type="image/png" href="/user/assets/img/favicon.png">
	<!-- google font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
	<!-- fontawesome -->
	<link rel="stylesheet" href="/user/assets/css/all.min.css">
	<!-- bootstrap -->
	<link rel="stylesheet" href="/user/assets/bootstrap/css/bootstrap.min.css">
	<!-- owl carousel -->
	<link rel="stylesheet" href="/user/assets/css/owl.carousel.css">
	<!-- magnific popup -->
	<link rel="stylesheet" href="/user/assets/css/magnific-popup.css">
	<!-- animate css -->
	<link rel="stylesheet" href="/user/assets/css/animate.css">
	<!-- mean menu css -->
	<link rel="stylesheet" href="/user/assets/css/meanmenu.min.css">
	<!-- main style -->
	<link rel="stylesheet" href="/user/assets/css/main.css">
	<!-- responsive -->
	<link rel="stylesheet" href="/user/assets/css/responsive.css">
		<!-- bootsrap icon cdn link -->
	 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<style>
 /* ================================
   Checkout Page Full CSS
================================ */

.checkout-section {
  background-color: #f8f9fa;
  min-height: 100vh;
  padding: 3rem 0;
}

.checkout-form,
.order-summary {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.checkout-form h4,
.order-summary h4 {
  font-weight: 700;
  color: #051922;
}

.form-label {
  color: #333;
  font-size: 0.95rem;
}

select.form-select,
input.form-control,
textarea.form-control {
  border-radius: 8px;
  border: 1px solid #ddd;
  padding: 0.75rem;
  font-size: 1rem;
  transition: all 0.2s ease-in-out;
}

select.form-select:focus,
input.form-control:focus,
textarea.form-control:focus {
  border-color: #F28123;
  box-shadow: 0 0 0 0.2rem rgba(242, 129, 35, 0.2);
}

.btn-outline-dark {
  border-radius: 6px;
  font-weight: 500;
  transition: 0.3s ease;
}

.btn-outline-dark:hover {
  background-color: #051922;
  color: #fff;
}

/* Main Checkout Button */
.btn-checkout {
  background-color: #F28123;
  color: #fff;
  font-weight: bold;
  border: none;
  padding: 12px;
  border-radius: 8px;
  transition: all 0.3s ease;
  width: 100%;
}

.btn-checkout:hover {
  background-color: #051922;
}

/* Responsive Select Box (for Address Dropdown) */
.responsive-select {
  width: 100%;
  overflow-x: auto;
}

.responsive-select select {
  width: 100%;
  min-width: 200px;
  max-width: 100%;
  white-space: normal;
  word-wrap: break-word;
}

/* ================================
   Order Summary (Right Section)
================================ */
.order-summary {
  padding: 2rem;
}

.order-summary .product-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1rem;
  border-bottom: 1px solid #eee;
  padding-bottom: 1rem;
}

.order-summary .product-name {
  font-weight: 500;
  color: #333;
}

.order-summary .product-price {
  color: #F28123;
  font-weight: 600;
}

.order-summary .summary-total {
  border-top: 2px solid #ddd;
  padding-top: 1rem;
  font-size: 1.1rem;
  font-weight: bold;
  color: #051922;
}

/* ================================
   Responsive Styling
================================ */
@media (max-width: 992px) {
  .checkout-section {
    padding: 2rem 1.5rem;
  }

  .checkout-form {
    padding: 1.5rem;
  }

  .order-summary {
    margin-top: 2rem;
  }

  .btn-checkout {
    font-size: 1rem;
  }
}

@media (max-width: 768px) {
  .checkout-form,
  .order-summary {
    padding: 1.5rem;
  }

  select.form-select,
  input.form-control,
  textarea.form-control {
    font-size: 0.9rem;
  }

  .checkout-section {
    padding: 1.5rem 0.75rem;
  }

  h4 {
    font-size: 1.2rem;
  }
}

@media (max-width: 576px) {
  .checkout-form,
  .order-summary {
    padding: 1rem;
  }

  .btn-checkout {
    padding: 10px;
    font-size: 0.9rem;
  }

  .responsive-select {
    overflow-x: visible;
  }
}

</style>
</head>
<body>
	
	<!--PreLoader-->
    <div class="loader">
        <div class="loader-inner">
            <div class="circle"></div>
        </div>
    </div>
    <!--PreLoader Ends-->
	
	<!-- header -->
		<%- include('partials/header') %>
	<!-- end header -->

	<!-- search area -->
	<div class="search-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<span class="close-btn"><i class="fas fa-window-close"></i></span>
					<div class="search-bar">
						<div class="search-bar-tablecell">
							<h3>Search For:</h3>
							<input type="text" placeholder="Keywords">
							<button type="submit">Search <i class="fas fa-search"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end search arewa -->
	
	<!-- breadcrumb-section -->
	<div class="breadcrumb-section breadcrumb-bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="breadcrumb-text">
						<p>Fresh and Organic</p>
						<h1>Check Out Product</h1>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end breadcrumb section -->

	<!-- check out section -->
<div class="checkout-section py-5">
  <div class="container">
    <div class="row gy-4">

<!-- Left: Address + Checkout Form -->
<div class="col-lg-7">
  <form action="/checkout" method="POST" class="checkout-form shadow p-4 rounded-3 bg-white">
    <h4 class="mb-4 text-dark fw-bold">Delivery Address</h4>
    <% if(address && address.length > 0) { %>
    <!-- Address Dropdown -->


    <div class="mb-3">
      <label class="form-label fw-semibold">Select Saved Address</label>
      <div class="responsive-select">
        <select class="form-select" name="selectedAddressId" required>
            <% if(isDef) { %> 
                  <option value="<%= isDef._id %>">
              <%= isDef.label %>  - <%= isDef.street %> , <%= isDef.city %> ,  <%= isDef.district %> ,  <%= isDef.pincode %> 
            </option>
             <% } %>

           <% address.forEach(addr => { %>
           
            <option value="<%= addr._id %>">
              <%= addr.label %>  - <%= addr.street %> , <%= addr.city %> ,  <%= addr.district %> ,  <%= addr.pincode %> 
            </option>
             <% }) %>
            
        </select>
      </div>
    </div>

    <!-- Add/Edit Address Button -->
    <div class="mb-4 text-end text-md-start">
      <a href="/profileAddress" class="btn btn-outline-dark btn-sm">
        <i class="fas fa-edit me-1"></i> Add / Edit Addresses
      </a>
    </div>

    <% } else { %>
  <!-- No Address Found -->
      <div class="text-center my-4">
        <p class="text-muted mb-3">No saved addresses found.</p>
        <a href="/profileAddress" 
          class="btn text-white" 
          style="background-color: #F28123; border-radius: 8px; padding: 8px 20px;">
          <i class="fas fa-plus me-1"></i> Add Address
        </a>
      </div>
      <% } %>

    <hr class="my-4">

    <!-- Personal Details -->
    <h4 class="mb-3 text-dark fw-bold">Contact Details</h4>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label fw-semibold">Full Name</label>
        <input type="text" name="fullName" value="<%= user.name %>" class="form-control" required>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label fw-semibold">Email</label>
        <input type="email" name="email" value="<%= user.email %>" class="form-control" required>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label fw-semibold">Phone Number</label>
        <input type="text" name="phone" value="<%= user.mobile %>" class="form-control" required>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label fw-semibold">Alternate Phone (Optional)</label>
        <input type="text" name="alternatePhone" class="form-control">
      </div>
    </div>

    <hr class="my-4">

    <!-- Payment Section -->
    <h4 class="mb-3 text-dark fw-bold">Payment Method</h4>
    <div class="mb-3">
      <label class="form-label fw-semibold">Select Payment Method</label>
      <select class="form-select" name="paymentMethod" required>
        <option value="cod">Cash on Delivery</option>
        <option value="card">Credit / Debit Card</option>
        <option value="upi">UPI (Google Pay, PhonePe, Paytm)</option>
        <option value="netbanking">Net Banking</option>
      </select>
    </div>

    <!-- Delivery Instructions -->
    <div class="mb-3">
      <label class="form-label fw-semibold">Delivery Instructions (optional)</label>
      <textarea name="instructions" class="form-control" rows="3" placeholder="E.g. Leave package at the door"></textarea>
    </div>

    <!-- Hidden Inputs for Backend -->
    <input type="hidden" name="cartId" value=" cart._id">
    <input type="hidden" name="totalAmount" value="cart.total">

    <button type="submit" class="btn btn-warning w-100 fw-bold mt-3">Proceed to Payment</button>
  </form>
</div>



      <!-- Right: Order Summary -->
      <div class="col-lg-5">
        <div class="order-summary shadow p-4 rounded-3 bg-white">
          <h4 class="mb-4 fw-bold text-dark">Order Summary</h4>

          <div class="order-items">
            <% products.forEach(item => { %>
            <div class="d-flex justify-content-between border-bottom py-2">
              <p class="mb-0"><%= item.product.name %> (x<%= item.quantity %>)</p>
              <p class="mb-0">â‚¹<%= item.totalPrice %></p>
            </div>
            <% }) %>
          </div>

          <div class="d-flex justify-content-between border-top pt-3 mt-3">
            <h5 class="fw-bold">Subtotal</h5>
            <h5 class="fw-bold">â‚¹<%= cart.subTotal %></h5>
          </div>

          <div class="d-flex justify-content-between pt-2">
            <p class="mb-0 text-muted">Delivery Charge</p>
            <p class="mb-0 text-muted">â‚¹<%= cart.shipping %></p>
          </div>

          <div class="d-flex justify-content-between border-top pt-3 mt-3">
            <h4 class="fw-bold text-dark">Total</h4>
            <h4 class="fw-bold text-dark">â‚¹<%= cart.total %></h4>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

	<!-- footer -->
		<%- include('partials/footer') %>
	<!-- jquery -->
	<script src="/user/assets/js/jquery-1.11.3.min.js"></script>
	<!-- bootstrap -->
	<script src="/user/assets/bootstrap/js/bootstrap.min.js"></script>
	<!-- count down -->
	<script src="/user/assets/js/jquery.countdown.js"></script>
	<!-- isotope -->
	<script src="/user/assets/js/jquery.isotope-3.0.6.min.js"></script>
	<!-- waypoints -->
	<script src="/user/assets/js/waypoints.js"></script>
	<!-- owl carousel -->
	<script src="/user/assets/js/owl.carousel.min.js"></script>
	<!-- magnific popup -->
	<script src="/user/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- mean menu -->
	<script src="/user/assets/js/jquery.meanmenu.min.js"></script>
	<!-- sticker js -->
	<script src="/user/assets/js/sticker.js"></script>
	<!-- main js -->
	<script src="/user/assets/js/main.js"></script>

</body>
</html>