<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain">

  <title>Fruitkha - Slider Version</title>

  <!-- favicon -->
  <link rel="shortcut icon" type="image/png" href="user/assets/img/favicon.png">
  <!-- google fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
  <!-- fontawesome -->
  <link rel="stylesheet" href="user/assets/css/all.min.css">
  <!-- bootstrap -->
  <link rel="stylesheet" href="user/assets/bootstrap/css/bootstrap.min.css">
  <!-- owl carousel -->
  <link rel="stylesheet" href="user/assets/css/owl.carousel.css">
  <!-- magnific popup -->
  <link rel="stylesheet" href="user/assets/css/magnific-popup.css">
  <!-- animate css -->
  <link rel="stylesheet" href="user/assets/css/animate.css">
  <!-- mean menu css -->
  <link rel="stylesheet" href="user/assets/css/meanmenu.min.css">
  <!-- main style -->
  <link rel="stylesheet" href="user/assets/css/main.css">
  <!-- responsive -->
  <link rel="stylesheet" href="user/assets/css/responsive.css">
  <!-- bootstrap icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <style>
    .payment-card {
      color: #F28123;
      border: 2px solid #F28123;
      border-radius: 10px;
      padding: 1rem;
      transition: transform 0.2s ease;
    }
    .payment-card .btn-orange {
      background-color: hash;
      color: #051922;
      border: none;
      font-weight: 600;
      border: 2px solid #051922;
    }
    .payment-card .btn-outline-danger {
      color: #F28123;
      border-color: #F28123;
    }
    .payment-card .btn-outline-danger:hover {
      background-color: #F28123;
      color: #051922;
    }
  </style>
</head>
<body>

  <!--PreLoader-->
  <div class="loader">
      <div class="loader-inner">
          <div class="circle"></div>
      </div>
  </div>
  <!--PreLoader Ends-->

  <!-- header -->
  <%- include('partials/header') %>
  <!-- end header -->

  <!-- breadcrumb-section -->
  <div class="breadcrumb-section breadcrumb-bg">
      <div class="container">
          <div class="row">
              <div class="col-lg-8 offset-lg-2 text-center">
                  <div class="breadcrumb-text">
                      <p>Your Full Details</p>
                      <h1>Profile</h1>
                  </div>
              </div>
          </div>
      </div>
  </div>
  <!-- end breadcrumb section -->

  <div class="container my-5">
    <h2 class="text-center mb-4" style="color:#F28123;">My Profile</h2>

    <!-- Navigation -->
    <ul class="nav nav-tabs justify-content-center border-0" id="profileTabs">
      <li class="nav-item">
        <a href="/profile" class="nav-link fw-bold text-dark"
           style="border:2px solid #F28123; border-bottom:none; border-radius:10px 10px 0 0;">
          Profile Info
        </a>
      </li>
      <li class="nav-item">
        <a href="/profileOrder" class="nav-link active fw-bold text-dark"
           style="border:2px solid #F28123; border-bottom:none; border-radius:10px 10px 0 0;">
          Orders
        </a>
      </li>
      <li class="nav-item">
        <a href="/profileAddress" class="nav-link fw-bold text-dark"
           style="border:2px solid #F28123; border-bottom:none; border-radius:10px 10px 0 0;">
          Addresses
        </a>
      </li>
      <li class="nav-item">
        <a href="/profileSetting" class="nav-link fw-bold"
           style="color:#F28123; border:2px solid #F28123;background-color: #051922; border-bottom:none; border-radius:10px 10px 0 0;">
          Settings
        </a>
      </li>
    </ul>

    <!-- === Settings Section === -->
    <div class="container my-5">
      <h2 class="text-center mb-4" style="color:#F28123;">Settings</h2>

      <!-- Change Password -->
      <div class="settings-card p-4 mb-3" style="border:2px solid #F28123; border-radius:8px; background:#fff;">
        <h5 class="fw-bold mb-3" style="color:#F28123;">Change Password</h5>
        <button class="btn-orange" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
          <i class="bi bi-key-fill"></i> Change Password
        </button>
      </div>

      <!-- Payment Card -->
      <div class="payment-card mb-3">
        <p class="mb-1 fw-bold">Visa **** 1234</p>
        <p class="mb-1">Expiry: 12/26</p>
        <button class="btn-orange btn-sm edit-payment" data-bs-toggle="modal" data-bs-target="#editPaymentModal">
          <i class="bi bi-pencil"></i> Edit
        </button>
        <button class="btn btn-outline-danger btn-sm delete-payment">
          <i class="bi bi-trash"></i> Delete
        </button>
      </div>

      <!-- Logout -->
      <div class="settings-card p-4 mb-3 text-center" style="border:2px solid #F28123; border-radius:8px; background:#fff;">
        <form method="GET" action='/logout'>
          <button class="btn btn-outline-danger"><i class="bi bi-box-arrow-right"></i> Logout</button>
        </form>
      </div>

      <!-- Delete Account -->
      <div class="settings-card p-4 mb-3 text-center" style="border:2px solid #F28123; border-radius:8px; background:#fff;">
        <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
          <i class="bi bi-trash-fill"></i> Delete Account
        </button>
      </div>
    </div>
  </div>

  <!-- === Change Password Modal === -->
  <!-- === Change Password Modal === -->
<div class="modal fade <%= showChangePasswordModal ? 'show' : '' %>" id="changePasswordModal" tabindex="-1" aria-hidden="true" style="<%= showChangePasswordModal ? 'display:block;' : '' %>">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" style="background-color:#051922; color:#F28123; border-bottom:2px solid #F28123;">
        <h5 class="modal-title fw-bold">Change Password</h5>
        <a href="/profileSetting"><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></a>
      </div>
      <div class="modal-body">
        <% if ( error && success ) { %>
          <div id="errorMsg" class="alert alert-success text-center"><%= error %></div>
        <% }else if(error) { %>
          <div id="errorMsg" class="alert alert-danger text-center"><%= error %></div>
          <%}%>

        <form action="/profileChangePassword" method="POST">
          <div class="mb-3">
            <label for="currentPassword" class="form-label fw-semibold" style="color:#051922;">Current Password</label>
            <input type="password" class="form-control" id="currentPassword" name="currentPassword" placeholder="Enter current password">
          </div>
          <div class="mb-3">
            <label for="newPassword" class="form-label fw-semibold" style="color:#051922;">New Password</label>
            <input type="password" class="form-control" id="newPassword" name="password" placeholder="Enter new password">
          </div>
          <div class="mb-3">
            <label for="confirmPassword" class="form-label fw-semibold" style="color:#051922;">Confirm New Password</label>
            <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm new password">
          </div>
          <div class="text-center">
            <button type="submit" class="btn" style="background-color:#F28123; color:#051922; font-weight:bold;">Submit</button>
          </div>
        </form>
        <div class="text-end mb-3">
        <form action="/forgotProfile" method="POST">
          <button type="submit" class="btn btn-link p-0" style="color:#F28123;">Forgot Password?</button>
        </form>
      </div>

      </div>
    </div>
  </div>
</div>

  <!-- === Delete Account Modal === -->
  <div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header" style="background-color:#051922; color:#F28123; border-bottom:2px solid #F28123;">
          <h5 class="modal-title fw-bold">Delete Account</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center">
          <p>Are you sure you want to delete your account? This action cannot be undone.</p>
          <div class="d-flex justify-content-center gap-3 mt-3">
            <form action="/delete" method="POST">
              <button type="submit" class="btn btn-danger">
                <i class="bi bi-trash-fill"></i> Yes, Delete
              </button>
            </form>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- === Edit Payment Modal === -->
  <div class="modal fade" id="editPaymentModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header" style="background-color:#051922; color:#F28123; border-bottom:2px solid #F28123;">
          <h5 class="modal-title fw-bold">Edit Payment Method</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
              <label for="cardNumber" class="form-label fw-semibold" style="color:#051922;">Card Number</label>
              <input type="text" class="form-control" id="cardNumber" value="**** 1234">
            </div>
            <div class="mb-3">
              <label for="cardName" class="form-label fw-semibold" style="color:#051922;">Cardholder Name</label>
              <input type="text" class="form-control" id="cardName" value="John Doe">
            </div>
            <div class="mb-3">
              <label for="expiryDate" class="form-label fw-semibold" style="color:#051922;">Expiry Date</label>
              <input type="text" class="form-control" id="expiryDate" value="12/26">
            </div>
            <div class="mb-3">
              <label for="cvv" class="form-label fw-semibold" style="color:#051922;">CVV</label>
              <input type="password" class="form-control" id="cvv" placeholder="***">
            </div>
            <div class="text-center">
              <button type="submit" class="btn" style="background-color:#F28123; color:#051922; font-weight:bold;">
                Save Changes
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- footer -->
  <%- include('partials/footer') %>
  <!-- end footer -->

  <!-- Scripts -->
  <script src="user/assets/js/jquery-1.11.3.min.js"></script>
  <script src="user/assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="user/assets/js/jquery.countdown.js"></script>
  <script src="user/assets/js/jquery.isotope-3.0.6.min.js"></script>
  <script src="user/assets/js/waypoints.js"></script>
  <script src="user/assets/js/owl.carousel.min.js"></script>
  <script src="user/assets/js/jquery.magnific-popup.min.js"></script>
  <script src="user/assets/js/jquery.meanmenu.min.js"></script>
  <script src="user/assets/js/sticker.js"></script>
  <script src="user/assets/js/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<% if (showChangePasswordModal) { %>
<script>
  var changePasswordModal = new bootstrap.Modal(document.getElementById('changePasswordModal'));
  changePasswordModal.show();
</script>
<script>
  // Select all input fields
  const inputs = document.querySelectorAll('input');

  // Select the error message div
  const errorDiv = document.getElementById('errorMsg');

  // Remove error when user focuses on any input
  inputs.forEach(input => {
    input.addEventListener('focus', () => {
      if (errorDiv) {
        errorDiv.style.display = 'none'; // hide the error
      }
    });
  });
</script>
<script>
  const changePasswordModalEl = document.getElementById('changePasswordModal');

  // Listen for modal close event
  changePasswordModalEl.addEventListener('hidden.bs.modal', function () {
    const errorDiv = document.getElementById('errorMsg');
    const successDiv = document.getElementById('successMsg');

    // Hide both error and success messages
    if (errorDiv) errorDiv.style.display = 'none';
    if (successDiv) successDiv.style.display = 'none';

    // Optional: clear input fields when modal closes
    const inputs = changePasswordModalEl.querySelectorAll('input');
    inputs.forEach(input => input.value = '');
  });
</script>
<% } %>
</body>
</html>
